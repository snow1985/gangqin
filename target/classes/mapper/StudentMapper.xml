<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mm.dao.StudentDao">

   <resultMap type="com.mm.entity.Student" id="studentmap">
     <id column="id" jdbcType="INTEGER" property="id"/>
     <result column="name" jdbcType="VARCHAR" property="name"/>
     <result column="age" jdbcType="INTEGER" property="age"/>
     <result column="address" jdbcType="VARCHAR" property="address"/>
     <result column="photo" jdbcType="BLOB" property="photo"/>
     <result column="information" jdbcType="VARCHAR" property="information"/>
     <result column="bak" jdbcType="VARCHAR" property="bak"/>
     <association property="mainFee" javaType="com.mm.entity.Mainfee">
        <id column="id" jdbcType="INTEGER" property="id"/>
        <result column="name" jdbcType="VARCHAR" property="name"/>
        <result column="unitprice" jdbcType="INTEGER" property="unitprice"/>
        <result column="surplushour" jdbcType="DOUBLE" property="surplushour"/>
        <result column="surplusfee" jdbcType="INTEGER" property="surplusfee"/>
        <result column="hishour" jdbcType="DOUBLE" property="hishour"/>
        <result column="hisfee" jdbcType="DOUBLE" property="hisfee"/>
        <result column="modifydate" jdbcType="DATE" property="modifydate"/>
        <result column="state" jdbcType="VARCHAR" property="state"/>
     </association>
     
   
   </resultMap>
  
   <select id="selectById" resultMap="studentmap">
        SELECT
			a.id,
			a.NAME,
			a.age,
			a.address,
			a.information,
			a.bak,
			b.id,
			b.name,
			b.unitprice,
			b.surplushour,
			b.surplusfee,
			b.hishour,
			b.hisfee,
			b.modifydate,
			b.state
		FROM
			student a , mainfee b
		WHERE a.id=#{id}
		    and  a.id =b.id
			and b.state = '1'
   </select>
   
   <select id="selectAll" resultMap="studentmap">
        SELECT
			a.id,
			a.NAME,
			a.age,
			a.address,
			a.information,
			a.bak,
			b.id,
			b.name,
			b.unitprice,
			b.surplushour,
			b.surplusfee,
			b.hishour,
			b.hisfee,
			b.modifydate,
			b.state
		FROM
			student a , mainfee b
		WHERE a.id =b.id
			and b.state = '1'
   </select>
   
   <insert id="addStudent" useGeneratedKeys="true" keyColumn="id" 
   keyProperty="id" parameterType="com.mm.entity.Student">
         insert into student (name,age,address,information,bak) values
         (#{name,jdbcType=VARCHAR},#{age,jdbcType=INTEGER}, #{address,jdbcType=VARCHAR}, 
      #{information,jdbcType=VARCHAR}, #{bak,jdbcType=VARCHAR})
   </insert>
  
</mapper>